@model List<GCI_Admin.Models.Member>

<div class="table-responsive p-2">

    <table id="membersTable" class="table table-striped table-hover w-100">
        <thead class="table-light">
            <tr>
                <th style="width:35px;"></th>
                <th style="width:50px;">#</th>
                <th>Name</th>
                <th>Phone</th>
                <th>Email</th>
                <th>Gender</th>
                <th>Assembly</th>
                <th>Joined</th>
                <th class="text-end">Actions</th>
            </tr>

            <!-- FILTER ROW -->
            <tr>
                <th></th>
                <th></th>
                <th><input type="text" placeholder="Search Name" class="form-control form-control-sm" /></th>
                <th><input type="text" placeholder="Phone" class="form-control form-control-sm" /></th>
                <th><input type="text" placeholder="Email" class="form-control form-control-sm" /></th>
                <th>
                    <select class="form-select form-select-sm">
                        <option value="">All</option>
                        <option value="Male">Male</option>
                        <option value="Female">Female</option>
                    </select>
                </th>
                <th><input type="text" placeholder="Assembly" class="form-control form-control-sm" /></th>
                <th></th>
                <th></th>
            </tr>
        </thead>

        <tbody>
            @if (Model != null && Model.Any())
            {
                int count = 1;
                foreach (var m in Model)
                {
                    var childContent = $@"
                        <div class='p-2'>
                        <strong>Gender:</strong> {m.Gender}<br/>
                        <strong>Email:</strong> {m.Email}<br/>
                        <strong>Phone:</strong> {m.Phone}<br/>
                        <strong>Assembly:</strong> {m.Assembly}<br/>
                        <strong>Joined:</strong> {m.CreatedAt:dd MMM yyyy}<br/>
                        <strong>Status:</strong> {m.StatusId}
                        </div>
                    ";

                    <tr data-child="@childContent">
                        <td class="text-center expand-row">
                            <i class="fa fa-chevron-right text-muted"></i>
                        </td>

                        <td>@count</td>
                        <td>@m.FirstName @m.OtherNames</td>
                        <td>@m.Phone</td>
                        <td>@m.Email</td>
                        <td>@m.Gender</td>
                        <td>@m.Assembly</td>
                        <td>@m.CreatedAt.ToString("dd MMM yyyy")</td>

                        <td class="text-end">

                            <!-- VIEW -->
                            <button class="btn btn-sm btn-outline-info" onclick="openModal('@Url.Action("Profile", new { id = m.Id })')">
                                <i class="fa fa-eye"></i>
                            </button>

                            <!-- EDIT -->
                            <button class="btn btn-sm btn-outline-warning" onclick="openModal('@Url.Action("Edit", new { id = m.Id })')">
                                <i class="fa fa-edit"></i>
                            </button>

                            <!-- DELETE -->
                            <button class="btn btn-sm btn-outline-danger" onclick="deleteMember(@m.Id)">
                                <i class="fa fa-trash"></i>
                            </button>

                            <!-- STATUS ACTION BUTTONS -->
                            @if (m.StatusId == 3)
                            {
                                <button class="btn btn-sm btn-outline-primary"
                                        onclick="joinMembershipClass(@m.Id)">
                                    <i class="fa fa-users"></i> Add to Membership Class
                                </button>
                            }
                            else if (m.StatusId == 2)
                            {
                                <button class="btn btn-sm btn-outline-success"
                                        onclick="makeFullMember(@m.Id)">
                                    <i class="fa fa-check-circle"></i> Make Full Member
                                </button>
                            }

                        </td>
                    </tr>

                    count++;
                }
            }
            else
            {
                <tr>
                    <td colspan="9" class="text-center text-muted py-3">
                        No members found
                    </td>
                </tr>
            }
        </tbody>
    </table>

</div>
